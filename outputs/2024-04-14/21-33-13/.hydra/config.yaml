arch:
  _target_: source.model.MultiMaskMultiSourceBandSplitRNN
  in_channel: 1
  stems:
  - speech
  - music
  - effects
  band_specs: musical
  n_bands: 48
  fs: 44100
  require_no_overlap: false
  require_no_gap: true
  normalize_channel_independently: false
  treat_channel_as_feature: true
  n_sqm_modules: 8
  emb_dim: 128
  rnn_dim: 256
  bidirectional: true
  rnn_type: GRU
  mlp_dim: 512
  hidden_activation: Tanh
  hidden_activation_kwargs: null
  complex_mask: true
  n_fft: 2048
  win_length: 2048
  hop_length: 512
  window_fn: hann_window
  wkwargs: null
  power: null
  center: true
  normalized: true
  pad_mode: constant
  onesided: true
data:
  train:
    batch_size: 2
    num_workers: 8
    datasets:
    - _target_: source.datasets.dnr.DivideAndRemasterRandomChunkDataset
      data_root: /home/comp/Рабочий стол/dnr_v2
      split: train
      target_length: 20000
      chunk_size_second: 6.0
      fs: 44100
  val:
    batch_size: 2
    num_workers: 8
    datasets:
    - _target_: source.datasets.dnr.DivideAndRemasterDeterministicChunkDataset
      data_root: /home/comp/Рабочий стол/dnr_v2
      split: val
      chunk_size_second: 6.0
      hop_size_second: 3.0
      fs: 44100
loss:
  _target_: source.loss.bsrnn.TimeFreqSignalNoisePNormRatioLoss
  kwargs:
    tkwargs:
      p: 1
    fkwargs:
      p: 1
scheduler:
  _target_: torch.optim.lr_scheduler.StepLR
  step_size: 2
  gamma: 0.98
metrics:
- _target_: source.metric.bsrnn.ScaleInvariantSignalNoiseRatio
  name: SI-SNR Metric
- _target_: source.metric.bsrnn.SignalNoiseRatio
  name: SNR Metric
preprocessing:
  sr: 44100
  log_spec: true
trainer:
  epochs: 100
  save_dir: saved/
  save_period: 1
  verbosity: 2
  monitor: min val_loss
  early_stop: 20
  visualize: wandb
  wandb_project: null
  wandb_name: null
  wandb_entity: null
  len_epoch: 1000
  batch_acum: 1
  log_step: 50
  grad_norm_clip: 400
optimizer:
  _target_: torch.optim.AdamW
  lr: 0.001
  betas:
  - 0.9
  - 0.98
  eps: 1.0e-09
name: main
n_gpu: 1
checkpoint: null
